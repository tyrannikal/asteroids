# Pre-commit hooks for Tiger Style compliance
# Run all validation tools automatically on git commit

repos:
  # Ruff - Format and lint
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.8.4
    hooks:
      - id: ruff-format
        name: ruff-format
        exclude: ^\.vulture_whitelist\.py$
      - id: ruff
        args: [--fix]
        name: ruff-lint
        exclude: ^\.vulture_whitelist\.py$

  # Mypy - Type checking
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.19.1
    hooks:
      - id: mypy
        additional_dependencies: [pygame==2.6.1, pydantic, pytest, pytest-mock]
        args: [--strict]
        exclude: ^(tests/|\.vulture_whitelist\.py)

  # Local hooks for tools not in pre-commit repos
  - repo: local
    hooks:
      # Pyright - Strict type checking (exclude tests - different type patterns)
      - id: pyright
        name: pyright
        entry: pyright
        language: system
        types: [python]
        exclude: ^(tests/|\.vulture_whitelist\.py$)
        pass_filenames: false

      # Pylint - Code quality (exclude tests - legitimate test patterns)
      - id: pylint
        name: pylint
        entry: pylint
        language: system
        types: [python]
        exclude: ^(tests/|\.vulture_whitelist\.py$)

      # Bandit - Security scanning (exclude tests - no security concerns)
      - id: bandit
        name: bandit
        entry: bandit
        language: system
        args: [-r, ., -ll, -x, "./.venv/,tests/"]
        types: [python]
        pass_filenames: false

      # Vulture - Dead code detection (whitelist for pytest fixture false positives)
      - id: vulture
        name: vulture
        entry: vulture
        language: system
        args: [., .vulture_whitelist.py, --min-confidence, "80", --exclude, ".venv"]
        types: [python]
        pass_filenames: false

      # Radon - Complexity checking (strict: A grade only)
      - id: radon
        name: radon-complexity
        entry: radon
        language: system
        args: [cc, ., -a, -nb, --min, A]
        types: [python]
        pass_filenames: false

      # MkDocs - Documentation build validation
      - id: mkdocs
        name: mkdocs-build-check
        entry: mkdocs
        language: system
        args: [build, --strict, --site-dir, ./build/mkdocs]
        pass_filenames: false
        files: '(mkdocs\.yml|docs/.*\.md|.*\.py$)'

        # Pytest - Run unit tests with coverage
      - id: pytest
        name: pytest
        entry: pytest
        language: system
        args: [--cov=., --cov-report=term-missing, --cov-fail-under=90, -q]
        types: [python]
        pass_filenames: false
        always_run: true
